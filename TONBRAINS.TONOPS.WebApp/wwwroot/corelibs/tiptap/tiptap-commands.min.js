
    /*!
    * tiptap-commands v1.6.0
    * (c) 2019 Scrumpy UG (limited liability)
    * @license MIT
    */


!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("prosemirror-commands"),require("prosemirror-schema-list"),require("prosemirror-inputrules"),require("prosemirror-state"),require("prosemirror-model"),require("tiptap-utils")):"function"==typeof define&&define.amd?define(["exports","prosemirror-commands","prosemirror-schema-list","prosemirror-inputrules","prosemirror-state","prosemirror-model","tiptap-utils"],t):t((e=e||self).tiptap={},e.prosemirrorCommands,e.prosemirrorSchemaList,e.prosemirrorInputrules,e.prosemirrorState,e.prosemirrorModel,e.tiptapUtils)}(this,function(e,a,i,t,r,n,c){"use strict";e.chainCommands=a.chainCommands,e.deleteSelection=a.deleteSelection,e.joinBackward=a.joinBackward,e.selectNodeBackward=a.selectNodeBackward,e.joinForward=a.joinForward,e.selectNodeForward=a.selectNodeForward,e.joinUp=a.joinUp,e.joinDown=a.joinDown,e.lift=a.lift,e.newlineInCode=a.newlineInCode,e.exitCode=a.exitCode,e.createParagraphNear=a.createParagraphNear,e.liftEmptyBlock=a.liftEmptyBlock,e.splitBlock=a.splitBlock,e.splitBlockKeepMarks=a.splitBlockKeepMarks,e.selectParentNode=a.selectParentNode,e.selectAll=a.selectAll,e.wrapIn=a.wrapIn,e.setBlockType=a.setBlockType,e.toggleMark=a.toggleMark,e.autoJoin=a.autoJoin,e.baseKeymap=a.baseKeymap,e.pcBaseKeymap=a.pcBaseKeymap,e.macBaseKeymap=a.macBaseKeymap,e.addListNodes=i.addListNodes,e.wrapInList=i.wrapInList,e.splitListItem=i.splitListItem,e.liftListItem=i.liftListItem,e.sinkListItem=i.sinkListItem,e.wrappingInputRule=t.wrappingInputRule,e.textblockTypeInputRule=t.textblockTypeInputRule,e.insertText=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){var r=e.selection.$from.pos.pos;return t(e.tr.insertText(n,r)),!0}},e.markInputRule=function(e,s,u){return new t.InputRule(e,function(e,t,r,n){var o=u instanceof Function?u(t):u,i=e.tr,a=n;if(t[1]){var c=t[0].search(/\S/),p=r+t[0].indexOf(t[1]),l=p+t[1].length;l<n&&i.delete(l,n),r<p&&i.delete(r+c,p),a=r+c+t[1].length}return i.addMark(r,a,s.create(o)),i.removeStoredMark(s),i})},e.markPasteRule=function(u,d,f){return new r.Plugin({props:{transformPasted:function(e){return new n.Slice(function l(e){var s=[];return e.forEach(function(e){if(e.isText){for(var t,r=e.text,n=0;null!==(t=u.exec(r));)if(t[1]){var o=t.index,i=o+t[0].length,a=o+t[0].indexOf(t[1]),c=a+t[1].length,p=f instanceof Function?f(t):f;0<o&&s.push(e.cut(n,o)),s.push(e.cut(a,c).mark(d.create(p).addToSet(e.marks))),n=i}n<r.length&&s.push(e.cut(n))}else s.push(e.copy(l(e.content)))}),n.Fragment.fromArray(s)}(e.content),e.openStart,e.openEnd)}}})},e.nodeInputRule=function(e,a,c){return new t.InputRule(e,function(e,t,r,n){var o=c instanceof Function?c(t):c,i=e.tr;return t[0]&&i.replaceWith(r-1,n,a.create(o)),i})},e.pasteRule=function(l,s,u){return new r.Plugin({props:{transformPasted:function(e){return new n.Slice(function c(e){var p=[];return e.forEach(function(e){if(e.isText){var t,r=e.text,n=0;do{if(t=l.exec(r)){var o=t.index,i=o+t[0].length,a=u instanceof Function?u(t[0]):u;0<o&&p.push(e.cut(n,o)),p.push(e.cut(o,i).mark(s.create(a).addToSet(e.marks))),n=i}}while(t);n<r.length&&p.push(e.cut(n))}else p.push(e.copy(c(e.content)))}),n.Fragment.fromArray(p)}(e.content),e.openStart,e.openEnd)}}})},e.removeMark=function(i){return function(e,t){var r=e.selection,n=r.from,o=r.to;return t(e.tr.removeMark(n,o,i))}},e.replaceText=function(){var p=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,l=1<arguments.length?arguments[1]:void 0,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){var r=e.selection,n=r.$from,o=r.$to,i=n.index(),a=p?p.from:n.pos,c=p?p.to:o.pos;return!!n.parent.canReplaceWith(i,i,l)&&(t&&t(e.tr.replaceWith(a,c,l.create(s))),!0)}},e.setInlineBlockType=function(o){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){var r=e.selection.$from,n=r.index();return!!r.parent.canReplaceWith(n,n,o)&&(t&&t(e.tr.replaceSelectionWith(o.create(i))),!0)}},e.splitToDefaultListItem=function(m){return function(e,t){var r=e.selection,n=r.$from,o=r.$to,i=r.node;if(i&&i.isBlock||n.depth<2||!n.sameParent(o))return!1;var a=n.node(-1);if(a.type!=m)return!1;if(0==n.parent.content.size){if(2==n.depth||n.node(-3).type!=m||n.index(-2)!=n.node(-2).childCount-1)return!1;if(t){for(var c=Fragment.empty,p=0<n.index(-1),l=n.depth-(p?1:2);l>=n.depth-3;l--)c=Fragment.from(n.node(l).copy(c));c=c.append(Fragment.from(m.createAndFill()));var s=e.tr.replace(n.before(p?null:-1),n.after(-3),new Slice(c,p?3:2,2));s.setSelection(e.selection.constructor.near(s.doc.resolve(n.pos+(p?3:2)))),t(s.scrollIntoView())}return!0}var u=o.pos==n.end()?a.contentMatchAt(n.indexAfter(-1)).defaultType:null,d=e.tr.delete(n.pos,o.pos),f=u&&[{type:m},{type:u}];return f||(f=[{type:m},null]),!!function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length?arguments[3]:void 0,o=e.resolve(t),i=o.depth-r,a=n&&n[n.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!a.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var c=o.depth-1,p=r-2;i<c;c--,p--){var l=o.node(c),s=o.index(c);if(l.type.spec.isolating)return!1;var u=l.content.cutByIndex(s,l.childCount),d=n&&n[p]||l;if(d!=l&&(u=u.replaceChild(0,d.type.create(d.attrs))),!l.canReplace(s+1,l.childCount))return!1}var f=o.indexAfter(i),m=n&&n[0];return o.node(i).canReplaceWith(f,f,m?m.type:o.node(i+1).type)}(d.doc,n.pos,2,f)&&(t&&t(d.split(n.pos,2,[{type:e.schema.nodes.todo_item,attrs:{done:!1}}]).scrollIntoView()),!0)}},e.toggleBlockType=function(n,o){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return function(e,t,r){return c.nodeIsActive(e,n,i)?a.setBlockType(o)(e,t,r):a.setBlockType(n,i)(e,t,r)}},e.toggleList=function(n,o){return function(e,t,r){return c.nodeIsActive(e,n)?i.liftListItem(o)(e,t,r):i.wrapInList(n)(e,t,r)}},e.toggleWrap=function(n){return function(e,t,r){return c.nodeIsActive(e,n)?a.lift(e,t):a.wrapIn(n)(e,t,r)}},e.updateMark=function(i,a){return function(e,t){var r=e.selection,n=r.from,o=r.to;return t(e.tr.addMark(n,o,i.create(a)))}},Object.defineProperty(e,"__esModule",{value:!0})});